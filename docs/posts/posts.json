[
  {
    "path": "posts/2021-03-11-palmetto-log-regression/",
    "title": "Logistic regression",
    "description": "Classification of palm species via by their morphological characteristics via logistic regression. Simple machnine learning example.",
    "author": [
      {
        "name": "Carmen Galaz-García",
        "url": {}
      }
    ],
    "date": "2021-01-29",
    "categories": [],
    "contents": "\n\nContents\nIntroduction\nData exploration\nBinary logistic regressionModel accuracy\n\nCitation\n\nIntroduction\nIn this report we use binary logistic regression to test the feasibility of using morphological characteristics to classify whether a palmetto plant is species serenoa repens or species sabal etonia. The variables we use for this classification are the height (cm), widest length of the canopy (cm), widest width of the canopy perpendicular to the canopy length (cm) and number of green leaves (n) in a palmetto plant. Data was collected by the Archbold Biological Station in south-central Florida from 1981 through 1997 then again in 2001 and 2017.\nAll analyses are in R version 4.0.2 using RStudio Version 1.3.1093.\n\n\n\n\n\n\n\n\n\nData exploration\n\nShow code\n# --- DATA SELECTION ---- \n\nraw_palmetto <- read_csv(\"palmetto.csv\")\n\npalmetto <- raw_palmetto %>% \n  select(species, height:green_lvs) %>% \n  mutate(species = case_when( species==1 ~ \"serenoa repens\",   # update species names\n                              species==2 ~ \"sabal etonia\"))\n\npalmetto$species<- as.factor(palmetto$species) # convert to factor\n#levels(palmetto$species)    # check factor levels\n\n\n\n\nShow code\n# --- GRAPH 1: CANOPY DIMENSIONS ---\n\nggplot(data=palmetto, aes(x=length, y=width))+\n  geom_point( cex=0.3, alpha=0.2)+    # point size and transparency\n  facet_wrap(~species)+     # divide by species\n  labs( x= \"length (cm)\",   # add labels and title\n        y= \"width (cm)\",\n       title = expression(paste(\n       \"Canopy dimensions in \",\n       italic(\"sabal etonia\"),\n       \" and \",\n       italic(\"serenoa repens\"),\n       \" individuals\"))\n        )+\n  #geom_smooth(method = \"lm\", se = FALSE, color = \"forestgreen\")+\n  theme_light()\n\n\n\n\nFigure 1. Relationship between widest length of the canopy (cm) and widest width of the canopy perpendicular to the canopy length (cm) of the palmetto plant species sabal etonia and serenoa repens. Each point indicates measurements of an individual plant. Data: Abrahamson (2019)\nFrom figure 1 we can see that canopy width and length for both plant species are positively correlated. Plants from sabal etonia species are slightly longer than those from serenoa repens.\n\nShow code\n# --- GRAPH 2: NUMBER OF LEAVES HISTOGRAM  ---\n\nggplot(data=palmetto, aes(x=green_lvs))+\n  geom_histogram(binwidth = 1)+  # update number of bins\n  facet_wrap(~species)+                     # divide by species\n  labs( x = \"number of green leaves (n)\",   # add labels and title\n        y = \"count\",\n        title = expression(paste(\n       \"Number of green leaves in \",\n       italic(\"sabal etonia\"),\n       \" and \",\n       italic(\"serenoa repens\"),\n       \" individuals\"))\n       )+\n  theme_light()\n\n\n\n\nFigure 2. Histograms of number of green leaves (n) in the palmetto plant species sabal etonia and serenoa repens. Data: Abrahamson (2019)\nIn figure 2 we can clearly see that most sabal etonia plants have 5 or less green levaes. These are fewer green leaves than what serenoa repens plants have, serenoa repens plants have a median of about 7 green leaves per plant.\n\nShow code\n# --- GRAPH 3: HEIGHT\n\nggplot(data=palmetto, aes(x=species, y=height))+\n  geom_jitter(color=\"forestgreen\", size=0.4, alpha=0.2) +\n  geom_boxplot(alpha=0)+\n  labs(y = \"height (cm)\",\n        title = expression(paste(\n       \"Height of \",\n       italic(\"sabal etonia\"),\n       \" and \",\n       italic(\"serenoa repens\"),\n       \" individuals\"))\n       )+\n  theme_minimal()\n\n\n\n\n\nShow code\n# ---- DESCRIPTIVE STATISTICS ----\nsummary_palmetto <- palmetto %>% \n  group_by(species) %>% \n  summarize(mean = mean(height, na.rm=TRUE),\n            sd = sd(height, na.rm=TRUE),\n            #median = median(weight, na.rm=TRUE),\n            n = n()\n            )\n\n# --- TWO SAMPLE T-TEST AND COHEN'S D ----\n\n# --- Convert data to vector form\nsabal_height <- palmetto %>% \n  filter(species == \"sabal etonia\") %>% \n  pull(height)\n\nserenoa_height <- palmetto %>% \n  filter(species == \"serenoa repens\") %>% \n  pull(height)\n\n# --- Two-sample t-test ---\nttest_height <- t.test(sabal_height,serenoa_height) %>% \n  tidy # make test parameters available for in-line referencing\n\n# --- Cohen's d ---\nheight_effsize <- cohen.d( serenoa_height,sabal_height, na.rm=TRUE)\n\n\n\nFigure 3. Height (cm) of the palmetto plant species sabal etonia and serenoa repens. Each green point indicates the height of an individual plant. Box endpoints indicate the 25th and 75th percentile values, the black line within the box indicate the median for each species. Black points at the end of the boxes indicate possible outliers. Data: Abrahamson (2019)\nOn average sabal etonia plants are shorter than serenoa repens plants: 90.09 \\(\\pm\\) 24.17 and 92.19 \\(\\pm\\) 28.11 cm, respectively (mean \\(\\pm\\) 1 standard deviation). The absolute difference in means is 2.1 cm, so on average the serenoa repens plants are 2.33% taller than sabal etonia plants. This difference in means is significant (Welch’s two-sample t-test: t(1.19707610^{4}) = -4.44, p< 0.001) however the effect size is small (Cohen’s d = 0.08).\nBinary logistic regression\nBased on the preliminary data visualization and analysis, it seems possible that the differences in canopy dimensions, height and number of green leaves for serenoa repens and sabal etonia plant species are significant. These characteristics could be used classify whether a palmetto plant belongs to either one of these species. To assess this we used a binary logistic regression to create a classification, the coefficients of the model are shown in the following table.\nTable 1.  Coefficients of the binary logistic regression model for classifying serenoa repens and sabal etonia palmetto plants based on their height (cm), canopy length and width (cm) and number of green leaves (n). The standard error and p-values for each coefficient are included. Data: Abrahamson (2019).\n\nShow code\n# ---- BINARY LOGISTIC REGRESSION ---- \n\n# -- create model\nblr_palmetto <- glm(species ~ height + length + width + green_lvs,\n                            data = palmetto,\n                            family = \"binomial\") #specify model is BLR\n\n# -- table with model information \nblr_model <- tidy(blr_palmetto) %>% \n  mutate(pvalue = \"< 0.001\") %>%     # after looking at p-values, they are all <0.001\n  mutate(term = c(\"y-intercept\",     # update variable names\n                  \"height (cm)\", \n                  \"length (cm)\", \n                  \"width (cm)\", \n                  \"number of green leaves (n)\")\n         ) %>% \n  select(!statistic & !p.value)%>%   # exclude statistic and p-value columns\n  kable( col.names = c(\"Variable\",   # turn into kable and update column names\n                        \"Coefficient\", \n                        \"Standard error\",\n                        \"p-value\") \n                         ) %>% \n   kable_styling(full_width = FALSE) \n\nblr_model\n\n\n\nVariable\n\n\nCoefficient\n\n\nStandard error\n\n\np-value\n\n\ny-intercept\n\n\n-3.2266851\n\n\n0.1420708\n\n\n< 0.001\n\n\nheight (cm)\n\n\n0.0292173\n\n\n0.0023061\n\n\n< 0.001\n\n\nlength (cm)\n\n\n-0.0458233\n\n\n0.0018661\n\n\n< 0.001\n\n\nwidth (cm)\n\n\n-0.0394434\n\n\n0.0021000\n\n\n< 0.001\n\n\nnumber of green leaves (n)\n\n\n1.9084747\n\n\n0.0388634\n\n\n< 0.001\n\n\nModel accuracy\nBased on the previous binary logistic regression we constructed a probability function \\(P\\) dependent on a plant’s height \\(h\\) (cm), canopy length \\(l\\) (cm), canopy width \\(w\\) (cm) and number of green leaves \\(n\\). Then \\(P(h,l,w,n)\\) is the probability that a palmetto plant with the specified measurements being a serenoa repens. If \\(X\\) is an individual of species serenoa repens with measurements \\(h, l,w\\) and \\(n\\), we consider \\(X\\) to be correctly classified by the model if \\(P(h,l,w,n)>0.5\\). Similarly, if \\(X\\) is an individual of species sabal etonia with measurements \\(h, l,w\\) and \\(n\\), we consider \\(X\\) to be correctly classified by the model if \\(P(h,l,w,n)\\leq 0.5\\).\nTable 2. Number and percentages of each species correctly and incorrectly classified by the model.\n\nShow code\n# ---- MODEL ACCURACY ---- \n\nresults_blr <- blr_palmetto %>% \n  broom::augment(type.predict=\"response\") %>% # calculate probability for each outcome\n  select(species,.fitted) %>%                 # select species and probability columns only\n  # check if classifcation is correct\n  mutate(classification = case_when( .fitted>0.5 & species==\"serenoa repens\"~ \"True\",   \n                                     .fitted<=0.5 & species==\"serenoa repens\"~ \"False\",\n                                     .fitted>0.5 & species==\"sabal etonia\"~ \"False\",\n                                     .fitted<=0.5 & species==\"sabal etonia\"~ \"True\")) %>% \n  count(species, classification) %>%    \n  mutate(percentage = case_when(     # add column with percentages \n    species == \"sabal etonia\" ~ scales::percent(n/(454+5701),accuracy = 0.01),\n    species == \"serenoa repens\" ~ scales::percent(n/(564+5548),accuracy = 0.01))\n    ) %>% \n  kable( col.names = c(\"Species\",    # create kable table, update column names\n                        \"Correctly classified by model\", \n                        \"Count\",\n                       \"Percentage\") \n                         ) %>% \n   kable_styling(full_width = FALSE)\n\nresults_blr\n\n\n\nSpecies\n\n\nCorrectly classified by model\n\n\nCount\n\n\nPercentage\n\n\nsabal etonia\n\n\nFalse\n\n\n454\n\n\n7.38%\n\n\nsabal etonia\n\n\nTrue\n\n\n5701\n\n\n92.62%\n\n\nserenoa repens\n\n\nFalse\n\n\n564\n\n\n9.23%\n\n\nserenoa repens\n\n\nTrue\n\n\n5548\n\n\n90.77%\n\n\nCitation\nAbrahamson, W.G. 2019. Survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017, ongoing at 5-year intervals ver 1. Environmental Data Initiative. https://doi.org/10.6073/pasta/f2f96ec76fbbd4b9db431c79a770c4d5\n\n\n\n",
    "preview": "posts/2021-03-11-palmetto-log-regression/palmetto-log-regression_files/figure-html5/unnamed-chunk-7-1.png",
    "last_modified": "2021-03-12T12:24:46-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-03-11-cheese-pca/",
    "title": "Principal Component Analysis (PCA)",
    "description": "How similar are cheeses depending on their country of origin? In this project we use principal component analysis (PCA) on the nutrition data for 45 types of cheeses from 10 countries to explore this question.",
    "author": [
      {
        "name": "Carmen Galaz-García",
        "url": {}
      }
    ],
    "date": "2021-01-25",
    "categories": [],
    "contents": "\nIntroduction\nIn this report we perform a principal component analysis (PCA) on the nutrition data for 45 types of cheeses and examine whether cheeses with the same country of origin form data clusters. The variables used in the analysis are energy (kcal), protein (g), fat (g), carbohydrate (g) and sugar (g) present in \\(x\\) grams of cheese. We assume the quantity \\(x\\) is the same for al cheeses, thought its value was unfortunately not found. We chose the variables according to what is usually most visible in the “Nutrition Facts” label in food products. A PCA analysis is appropriate given the sample size (greater than 10) and since all the indicated variables are continuous. We work under the assumption that variables are linearly related.\nThe data comes from the Food nutrient information for raw fruits and veggies from USDA database of the FoodData Central in the U.S. Department of Agriculture. https://fdc.nal.usda.gov/index.html\nAll analyses are in R version 4.0.2 using RStudio Version 1.3.1093.\n\n\n\nFigure 1: ‘Cheese’ by rjhuttondfw is licensed under CC BY 2.0\n\n\n\nData wrangling\n\nShow code\n# ---- DATA READING ----\nfood <- read.csv(here(\"Task2_PCA\",\"usda_nutrients.csv\")) %>% \n  clean_names() %>%      \n  drop_na()              # remove NA values\n\n# ----- DATA SELECTION -----\ncheeses <- food %>% \n  filter(str_detect(short_descrip, \"CHEESE,\"),   # select cheeses\n         str_detect(food_group, \"Dairy\") ) %>% \n  select(!(id:short_descrip) & !(common_name:scientific_name)) %>%   # select variables used in analysis\n  select(descrip:sugar_g) %>% \n  mutate(descrip = str_sub(descrip, start=9)) %>% # remove \"cheese\" from description\n  separate(descrip,                               # separate cheese name from characteristics\n           into=c(\"name\", \"type\"), \n           sep=\",\", \n           extra=\"merge\") %>%\n  filter(!str_detect(name,\"fat|pasteurized|sodium\")) %>%     # remove \"altered\" cheeses\n  filter(!str_detect(type,\"fat|pasteurized|sodium|with|low|imitation\") | is.na(type)) %>% \n  mutate(origin = case_when(                      # label each cheese by country of origin\n    name == \"mexican\" ~ \"mex\",\n    str_detect(type,\"queso\")~ \"mex\",\n    str_detect(name,\"cheddar|cottage|monterey|muenster|brick|caraway|colby\") ~ \"us\",\n    str_detect(name,\"fontina|parmesan|mozzarella|provolone|ricotta|romano\") ~ \"it\",\n    str_detect(name,\"camembert|brie|roquefort|port de salut|blue\")~ \"fr\",\n    str_detect(name,\"gruyere|neufchatel|swiss|tilsit\") ~ \"sw\",\n    str_detect(name,\"gouda|edam|limburger\") ~ \"nth\"\n  )) %>% \n  relocate(origin)    # group categorical variables at beginning\n\n\n\nPrincipal Component Analysis and Biplot\n\nShow code\n# ---- PRINCIPAL COMPONENT ANALYSIS ----\ncheeses_PCA <- cheeses %>% \n  select(4:8) %>%    # select numerical variables\n  scale() %>% \n  prcomp\n\n# ----- BIPLOT -----\ncheese_biplot <- autoplot(cheeses_PCA,   # automatically recognizes PCA and does biplot\n         data= cheeses,\n         colour = 'origin',\n         #shape=FALSE,      # takes out points and shows individual labels\n         #label.size = 4,\n         loadings = TRUE,\n         loadings.label=TRUE)  +\n  theme_minimal()  +\n  labs(colour=\"Country of origin\") +  # add labels\n  scale_color_hue(labels= c(\"France\", \"Italy\", \"Mexico\",\"Netherlands\",\"Switzerland\",\"USA\", \"Other\"))\n\ncheese_biplot\n\n\n\n\n\n\nFigure 2. PCA biplot showing the relationships between energy (kcal), protein (g), fat (g), carbohydrate (g) and sugar (g) present in \\(x\\) grams of cheese. Each dot represents a different type of cheese. The color of a dote indicates the country of origin of the cheese.\nExploratory Findings\nThe PCA for our cheeses data set reveals that 71.32% of the variability is explained by the first two principal components. The biplot in figure 2 shows there is a similar and large variance with respect to PC1 and PC2 across energy, fat and protein content, while sugar content has a small variance. Figure 1 also shows the following major relations between the variables:\nSugar and protein present in cheese are negatively correlated.\nCarbohydrates seem to be quite unrelated to all other variables.\nEnergy and fat are positively correlated.\nAs for data clusters with respect to the cheese’s country of origin the biplot shows that:\nCheeses from the US form the tightest cluster, with cottage cheese as an outlier on the far right. Mexican cheeses also form a small cluster with small coefficients on both PC1 and PC2.\nItalian cheeses are quite spread out along PC1, with shredded parmesan on the far left and ricotta on the far right.\nGjetost cheese (a kind of Norwegian cheese) on the top seems like the biggest outlier.\n\n\n\n",
    "preview": "posts/2021-03-11-cheese-pca/cheese_PCA.jpeg",
    "last_modified": "2021-03-12T11:51:42-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-03-12-hares-linear-regression/",
    "title": "Linear regression model",
    "description": "Analysis of snowshoe hares' characteristics and numbers at the Bonanza Creek Experimental Forest.",
    "author": [
      {
        "name": "Carmen Galaz-García",
        "url": {}
      }
    ],
    "date": "2020-11-15",
    "categories": [],
    "contents": "\n\nContents\nIntroduction\nData and analysis\nExploratory findingsAnnual juvenile hare trap counts\nJuvenile hare weights by sex and sample site\nWeight comparison in male & female snowshoe hares\nRelationship between juvenile weight & hind foot length\n\nSummary\nCitations\n\nIntroduction\nIn this report we examine the counts, weight and size measurements of juvenile snowshoe hares observed at the Bonanza Creek Experimental Forest from 1999 to 2012 (Kielland et al. 2017). In particular, we look at how the number of observations of juvenile snowshoe hares has changed over the course of the study, how weight varies across sex and sampling site and explore a possible linear relation between hares’ weight and hind foot length.\n\nPicture credit: Jim Dau, Alaska Department of Fish and Game\nData and analysis\nSize measurements, sex and age of snowshoe hares were collected and made available by Dr. Knut Kielland and colleagues at the Bonanza Creek Experimental Forest Long Term Ecological Research (LTER) site located approximately 20 km southwest of Fairbanks, Alaska. The data contains observations of 3197 snowshoe hares obtained by capture-recapture studies conducted yearly from 1999 to 2012 in three sampling sites: Bonanza Riparian, Bonanza Mature and Bonanza Black Spruce. Out of the total observations, 378 correspond to juvenile snowshoe hares.\nThis report has four sections, each focused on analyzing different data related to juvenile snowshoe hares.\nSection 1) Annual juvenile hare trap counts\nExploration of the counts by year of juvenile snowshoe hares.\nSection 2) Juvenile hare weights by sex and sample site\nVisualization and analysis of descriptive statistics for the weight of male and female juvenile snowshoe hares across the three sampling sites.\nSection 3) Weight comparison by sex of juvenile hares\nAnalysis of the difference in average weight of male and female juvenile hares. To do so we use a Welch two-sample t-test with a significance level of 0.05 (\\(\\alpha\\)) and calculate Cohen’s d effect size.\nSection 4) Relationship between juvenile weight & hind foot length\nAnalysis of a possible relation between hind foot length and weight of juvenile hares, conducted using a simple linear regression model on these variables. Fitness of this model is discussed.\nAll analyses are in R version 4.0.2 using RStudio Version 1.3.1093.\nExploratory findings\nAnnual juvenile hare trap counts\nIn this section we analyze yearly counts of juvenile snowshoe hares. In total 378 observations of juvenile snowshoe hares were recorded during the study. Sample site is not included as a variable here, though it would be it would be interesting to see if juvenile hare counts are changing equally in all sample sites.\n\nhide\n# --- Count juveniles per year\nper_year_juveniles <- hares %>%    # copy data\n  filter(age == \"j\") %>%       # select juvenile hares\n  mutate(Year = year(mdy(date))) %>%     # create new column with year\n  count(Year)\n\n# --- Create graph\nggplot( data= per_year_juveniles, aes(x =Year, y =n)) +   # select data and variables\n  geom_bar(stat=\"identity\", fill=\"snow4\") +    # do a bar plot\n  scale_x_continuous(breaks=2*(994:1006)) +   # adjust ticks\n  labs(#title=\"Juvenile snowshoe hares observations recorded yearly\",\n       y= \"Number of hares (n)\") +\n  theme_light()  # update theme\n\n\n\n\nFigure 1. Total juvenile snowshoe hare observations (n) during each year of the study (1999-2012). Data: Kielland et al. (2017)\nNo observations of juvenile snowshoe hares were made during 2002 and 2009, while the highest count was registered in 1999 (the first year of the study) with 126 observations. On average 31.5 juvenile hare trappings were made from 1999 to 2012 and the median was 18.5. In figure one we can see a diminishing trend in the number of juvenile hare trappings. The two exceptions are 2005, 2008 and 2011. In 2005 juvenile hare counts were 6 times higher than in 2004, and in 2008 counts were 8.8 times higher than in 2007. In 2011 the juvenile snowshoe hare count was 9.5 times higher than in 2010.\nWhile these are absolute counts, these numbers are also impacted by effort. Moving forward I would suggest to conduct the trappings on the same dates every year and space these times across different seasons. For example the first two weeks of each month every year. I imagine juveniles are mostly present during Spring, but with climate change it is possible Spring weather does not come at the same dates in 2012 as in 1998, so there might be a risk of undercounting if the counts are done during a fixed period of time every year. I would also suggest to maintain the number and location of traps constant over the years.\nJuvenile hare weights by sex and sample site\n\nhide\n# --- Select data\nsummary_juveniles <- juveniles %>% \n  group_by(grid, sex) %>% \n  summarize(mean = mean(weight, na.rm=TRUE),\n            sd = sd(weight, na.rm=TRUE),\n            #median = median(weight, na.rm=TRUE),\n            n = n()\n            )\n\n\n\nWeights (measured in grams) of male and female juvenile snowshoe hares are compared across the three sampling sites: Bonanza Black Spruce, Bonanza Mature and Bonanza Riparian. From the 378 observations of juvenile snowshoe hares recorded during the study, 7 of them did not have the hare’s weight recorded (3 females and 4 of unidentified sex).\nIn all three sites the average weight for male juvenile hares is greater than that of female juvenile hares. Juvenile hares were biggest at the Bonanza Black Spruce sampling site, with weight of male hares being 1073 \\(\\pm\\) 223 grams (n= 13; mean \\(\\pm\\) 1 standard deviation) and weight of female hares being 1022 \\(\\pm\\) 293 grams (n= 35). In Bonanza Mature and Bonanza Riparian the average and standard deviations of weights were similar for both female and male juvenile hares.\nTable 1. Descriptive statistics (mean, standard deviation and sample size) at each sample site for female and male juvenile snowshoe hares. Data: Kielland et al. (2017)\n\nhide\n# --- Create table with summary statistics \n\nweight_summary_table <- summary_juveniles %>% \n  mutate(\n       grid = case_when( # update names of sample sites\n         grid == \"bonbs\" ~ \"Bonanza Black Spruce\",\n         grid == \"bonrip\" ~ \"Bonanza Riparian\", \n         grid == \"bonmat\" ~ \"Bonanza Mature\"\n       ),\n       sex = case_when(   # update names of sex\n         sex == \"f\" ~ \"female\",\n         sex == \"m\" ~\"male\"\n       )) %>% \n  kable( col.names = c(\"Sample site\", \n                        \"Sex\", \n                        \"Mean weight (g)\",\n                        \"Standard deviation (g)\",\n                        #\"Median weight (g)\",\n                        \"Sample size (n)\" ) \n                         ) %>% \n   kable_styling(full_width = FALSE)\nweight_summary_table\n\n\n\nSample site\n\n\nSex\n\n\nMean weight (g)\n\n\nStandard deviation (g)\n\n\nSample size (n)\n\n\nBonanza Black Spruce\n\n\nfemale\n\n\n1022.0588\n\n\n292.9632\n\n\n35\n\n\nBonanza Black Spruce\n\n\nmale\n\n\n1073.0769\n\n\n222.6408\n\n\n13\n\n\nBonanza Black Spruce\n\n\nNA\n\n\nNaN\n\n\nNA\n\n\n1\n\n\nBonanza Mature\n\n\nfemale\n\n\n808.1944\n\n\n361.1235\n\n\n36\n\n\nBonanza Mature\n\n\nmale\n\n\n950.1250\n\n\n314.6864\n\n\n40\n\n\nBonanza Mature\n\n\nNA\n\n\n816.6667\n\n\n307.0939\n\n\n7\n\n\nBonanza Riparian\n\n\nfemale\n\n\n824.1496\n\n\n255.0350\n\n\n129\n\n\nBonanza Riparian\n\n\nmale\n\n\n929.2727\n\n\n349.1660\n\n\n110\n\n\nBonanza Riparian\n\n\nNA\n\n\n372.0000\n\n\n258.7856\n\n\n7\n\n\nDistribution of weights for female and male juvenile hares appear to be more normal at the Bonanza Riparian site and rather uniform at the other two sites. Note that the Bonanza Riparian site has almost four times as many observations than the other two sites for female hares. For male hares Bonanza Riparian site has about twice as many observations than Bonanza Mature and almost 10 times more than Bonanza Black Spruce. In all three sites and for both sexes the eight mean and median are similar.\n\nhide\n# ---  Create graph of juvenile weight divided by sex and grid\n\n# -- individual figure titles\ngrid_names <- c(bonbs=\"Bonanza Black Spruce\", \n                bonrip=\"Bonanza Riparian\", \n                bonmat=\"Bonanza Mature\")\n\n# -- make beeswax plot with added box-plot on top\nggplot(data = juveniles, aes(x = sex, y = weight) ) +\n  geom_beeswarm(show.legend=FALSE,\n                aes(color=sex),\n                size = 4,    # point size\n                alpha = 0.6, # transparency\n                pch = 20,    # point shape\n                cex=2.5      # scatters points\n                ) +\n  geom_boxplot(fill = NA, width = 0.2, outlier.color = NA) +\n  stat_summary(fun=mean, \n               geom=\"point\", \n               shape=20, \n               size=3, \n               color=\"black\", \n               fill=\"black\")+\n  facet_wrap(~grid,   # make one graph per grid element\n             labeller = labeller( grid = grid_names)) +   # update individual titles\n  labs(y=\"Weight (g)\", x=\"Sex\") +\n  scale_x_discrete(labels = c(\"female\", \"male\", \"NA\")) +   # update x-axis labels \n  theme_light()  # update theme\n\n\n\n\nFigure 2. Weight (g) of juvenile snowshoe hares recorded in each sampling site, divided by sex. Red (female), blue (male) and gray (unidentified) points indicate individual observations of weight (g) of a juvenile snowshoe hare. Box endpoints indicate the 25th and 75th percentile values, the black line and black point within the box indicate the median and mean value for each species, respectively. Data: Kielland et al. (2017)\nWeight comparison in male & female snowshoe hares\n\nhide\n# --- Data Selection & Summary Statistics\n\n# --- checking how many hares don't have weight registered\n#View(filter(juveniles,is.na(weight)))    # seven juvenile hares with weight==NA\n\n# --- separate data of female and male juvenile hares with recorded weight\nfemale_male <-  juveniles %>%   # copy data\n  filter(!is.na(weight)) %>%           # select those with recorded weight\n  filter(!is.na(sex))                  # select those with recorded sex\n\n# --- create descriptive statistics for weight of female and male hares\nfemale_male_summary <- female_male %>%   # copy data\n  group_by(sex) %>% \n  summarize(mean = mean(weight, na.rm=TRUE),\n            sd = sd(weight, na.rm=TRUE),\n            #median = median(weight, na.rm=TRUE),\n            n = n())\n\n\n\n\nhide\n# --- Exploring data to ensure 2-sample t-test is adequate\n\n# Histograms: female hares normal, male hares too though slightly bimodal\nggplot(data = female_male, aes(x = weight)) +\n  geom_histogram(bins = 25) +\n  facet_wrap(~sex)\n\n# QQ Plots: both graphs close to a line, males a bit wobbly on bottom\nggplot(data= female_male, aes(sample = weight)) +\n  geom_qq() +\n  facet_wrap(~sex)\n\n\n\n\nhide\n# --- Two-sample t-test & Cohen's d ----\n\n# --- Convert data to vector form\njuvenile_female <- female_male %>% \n  filter(sex == \"f\") %>% \n  pull(weight)\n\njuvenile_male <- female_male %>% \n  filter(sex == \"m\") %>% \n  pull(weight)\n\n# --- Two-sample t-test ---\nttest_juveniles <- t.test(juvenile_male,juvenile_female) %>% \n  tidy # make test parameters available for in-line referencing\n\n# --- Cohen's d ---\njuveniles_effsize <- cohen.d(juvenile_male,juvenile_female)\n\n\n\nOut of 378 observations of juvenile snowshoe hares we excluded from this analysis those which did not have the hare’s sex or weight recorded, this left us with 360 observations\n(197 females and 163 males).\nOn average for juvenile snowshoe hares, males weigh more than females (945.86 \\(\\pm\\) 333.22 and 855.39 \\(\\pm\\) 292.25 grams, respectively; mean \\(\\pm\\) 1 standard deviation). The absolute difference in means is 90 grams, so male hares weigh 11% more than females. This difference in means is significant (Welch’s two-sample t-test: t(325.02) = 2.71, p=0.0071 < \\(\\alpha\\)), though the effect size is small (Cohen’s d = 0.29).\nTable 2. Descriptive statistics (mean, standard deviation, and sample size) for female and male juvenile snowshoe hares. Data: Kielland et al. (2017)\n\nhide\n# --- Create summary table\n\n# -- update tags for table\nfemale_male_summary[1,1] <- \"female\"  \nfemale_male_summary[2,1] <- \"male\"  \n\n# -- make table\nfemale_male_summary %>% kable( col.names = c(\"Sex\", \n                                       \"Mean weight (g)\", \n                                       \"Standard deviation (g)\",\n                                       #\"Median weight (g)\",\n                                       \"Sample size (n)\" ) \n                         ) %>% \n   kable_styling(full_width = FALSE)\n\n\n\nSex\n\n\nMean weight (g)\n\n\nStandard deviation (g)\n\n\nSample size (n)\n\n\nfemale\n\n\n855.3909\n\n\n292.2526\n\n\n197\n\n\nmale\n\n\n945.8589\n\n\n333.2151\n\n\n163\n\n\nRelationship between juvenile weight & hind foot length\nIn this section we explore the relationship between juvenile snowshoe hare hind foot length and weight. Out of the total 378 observations, we run the analysis on the 249 observations that include records of both hind foot length and weight.\n\nhide\n# --- Linear Model: weight(hindft) ---\n\n# -- select data with recorded weight and recorded hindft\ncomplete_juveniles <- juveniles %>% \n  filter(is.na(weight)==FALSE & is.na(hindft)==FALSE)\n# View(filter(juveniles, is.na(weight) | is.na(hindft))) # checking the leftout data\n\n# -- linear model for weight(hindft)\njuveniles_lm <- lm(weight ~ hindft, data=complete_juveniles)\n#summary(juveniles_lm)\n\n# -- accessing data in linear model\n# tidy versions of model outputs tp use in-text (converted to data frame)\ntidy_juveniles_lm <- broom::tidy(juveniles_lm) \njuveniles_lm_glance <- glance(juveniles_lm)\n\n# -- Pearson's R correlation\njuveniles_corr <- cor.test(complete_juveniles$weight, complete_juveniles$hindft) %>% \n  tidy\n\n\n\nIn Figure 3 we can see most of the data follows a linear trend, thought there is a significant number of points on the bottom right part of the graph which do not behave linearly. To analyze a possible linear dependence of body mass with respect to flipper length we used simple linear regression. This analysis revealed that variance in weight of juvenile hares is not quite explained by hind foot length (p < 0.001, R2 = 0.3). The average slope of the linear model is \\(\\beta\\) = 9.52 g mm-1 (i.e., for each one millimeter increase in hind foot length we expect an average increase in weight of 9.52 g). A Pearson’s r of 0.55 (p < 0.001) shows weight is positively correlated to hind foot length with medium strength.\n\nhide\n# --- Relationship between juvenile hind foot length and weight\n\n# --- Graph\nggplot(data= complete_juveniles, aes(y=weight, x=hindft))+\n  geom_point(  alpha = 0.4) +\n  labs( y=\"Weight (g)\", \n        x=\"Hind foot length (mm)\")+\n  geom_smooth(method = \"lm\", se = FALSE, color = \"gray30\")+\n  theme_light()  # update theme\n\n\n\n\nFigure 3. Relationship between hind foot length (mm) and weight (g) of juvenile snowshoe hares. Points indicate individual hare measurements. Linear model summary: \\(\\beta\\)1 = 9.52 g mm-1, p < 0.001, R2 = 0.3, Pearson’s r = 0.55). Data: Kielland et al. (2017)\nOverall a linear model of weight with respect to hind foot length does not account completely for the change in the dependent variable. Apart from data not following entirely a linear trend, further explorations show residuals are not entirely normally distributed and violate homoscedasticity (do not appear to be randomly distributed).\nNotice that sex is not included as a variable in the previous analysis. If we consider observations for female and male hares separately we can see in Figure 4 that data for female hares follows a more linear trend while data for male hares tends to spread out more. It would be interesting to consider a linear model for each of these groups separately.\n\nhide\n# --- Relationship between juvenile hind foot length and weight, by sex\n\n#  update of names \ncomplete_juveniles  <- complete_juveniles %>% mutate(\n        sex = case_when(   # update names of sex\n         sex == \"f\" ~ \"female\",\n         sex == \"m\" ~\"male\"\n       ))\n\n# --- Graph\nggplot(data= complete_juveniles, aes(y=weight, x=hindft, color=sex))+\n  geom_point( alpha = 0.7) +\n  labs( y=\"Weight (g)\", \n        x=\"Hind foot length (mm)\")+\n  theme_light() + # update theme\n  theme(legend.position = c(0.15, 0.7))\n\n\n\n\nFigure 4. Relationship between hind foot length (mm) and weight (g) of juvenile snowshoe hares divided by sex. Red (female), blue (male) and gray (unidentified) points indicate individual observations of juvenile snowshoe hares. Data: Kielland et al. (2017)\nSummary\nExploratory data analysis reveals the following findings:\nJuvenile snowshoe hare observations have overall diminished yearly since the study started in 1999.\nHares observed at the Bonanza Black Spruce sampling site were on average bigger than hares observed at Bonanza Mature and Bonanza riparian, where the weight average for male and female hares were similar.\nOn average male juvenile hares weigh more than female hares and the difference in means is significant (Welch’s two-sample t-test: t(325.02) = 2.71, p=0.0071 < \\(\\alpha\\)), though the effect size is small (Cohen’s d = 0.29).\nThere is no conclusive evidence of a linear relationship between hind foot length and weight in the total observations for juvenile snowshoe hares.\nNext steps:\nMake a finer analysis of the count of juvenile hares that takes into account the month of the observation and not only the year.\nAnalyze whether the difference in average weight between the different sample sites is significant. A one-way ANOVA could be used. though given the difference in sample sizes at each site further analysis might be needed.\nInclude sex variable in the linear analysis of weight as a variable of hind foot or analyze female and male hares separately.\nCitations\nKielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017. Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present ver 22. Environmental Data Initiative. (https://doi.org/10.6073/pasta/03dce4856d79b91557d8e6ce2cbcdc14) (Accessed 2020-11-19).\n\n\n\n",
    "preview": "posts/2021-03-12-hares-linear-regression/hares-linear-regression_files/figure-html5/unnamed-chunk-4-1.png",
    "last_modified": "2021-03-12T12:59:50-08:00",
    "input_file": "hares-linear-regression.utf8.md"
  }
]
