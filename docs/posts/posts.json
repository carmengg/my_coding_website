[
  {
    "path": "posts/2021-03-11-palmetto-log-regression/",
    "title": "Classification of palmetto species via machine learning",
    "description": "by their morphological characteristics A short description of the post.",
    "author": [
      {
        "name": "Carmen Galaz-García",
        "url": {}
      }
    ],
    "date": "2021-01-29",
    "categories": [],
    "contents": "\n\nContents\nIntroduction\nData exploration\nBinary logistic regressionModel accuracy\n\nCitation\n\nIntroduction\nIn this report we use binary logistic regression to test the feasibility of using morphological characteristics to classify whether a palmetto plant is species serenoa repens or species sabal etonia. The variables we use for this classification are the height (cm), widest length of the canopy (cm), widest width of the canopy perpendicular to the canopy length (cm) and number of green leaves (n) in a palmetto plant. Data was collected by the Archbold Biological Station in south-central Florida from 1981 through 1997 then again in 2001 and 2017.\nAll analyses are in R version 4.0.2 using RStudio Version 1.3.1093.\nData exploration\n\nhide\n# --- DATA SELECTION ---- \n\nraw_palmetto <- read_csv(\"palmetto.csv\")\n\npalmetto <- raw_palmetto %>% \n  select(species, height:green_lvs) %>% \n  mutate(species = case_when( species==1 ~ \"serenoa repens\",   # update species names\n                              species==2 ~ \"sabal etonia\"))\n\npalmetto$species<- as.factor(palmetto$species) # convert to factor\n#levels(palmetto$species)    # check factor levels\n\n\n\n\nhide\n# --- GRAPH 1: CANOPY DIMENSIONS ---\n\nggplot(data=palmetto, aes(x=length, y=width))+\n  geom_point( cex=0.3, alpha=0.2)+    # point size and transparency\n  facet_wrap(~species)+     # divide by species\n  labs( x= \"length (cm)\",   # add labels and title\n        y= \"width (cm)\",\n       title = expression(paste(\n       \"Canopy dimensions in \",\n       italic(\"sabal etonia\"),\n       \" and \",\n       italic(\"serenoa repens\"),\n       \" individuals\"))\n        )+\n  #geom_smooth(method = \"lm\", se = FALSE, color = \"forestgreen\")+\n  theme_light()\n\n\n\n\nFigure 1. Relationship between widest length of the canopy (cm) and widest width of the canopy perpendicular to the canopy length (cm) of the palmetto plant species sabal etonia and serenoa repens. Each point indicates measurements of an individual plant. Data: Abrahamson (2019)\nFrom figure 1 we can see that canopy width and length for both plant species are positively correlated. Plants from sabal etonia species are slightly longer than those from serenoa repens.\n\nhide\n# --- GRAPH 2: NUMBER OF LEAVES HISTOGRAM  ---\n\nggplot(data=palmetto, aes(x=green_lvs))+\n  geom_histogram(binwidth = 1)+  # update number of bins\n  facet_wrap(~species)+                     # divide by species\n  labs( x = \"number of green leaves (n)\",   # add labels and title\n        y = \"count\",\n        title = expression(paste(\n       \"Number of green leaves in \",\n       italic(\"sabal etonia\"),\n       \" and \",\n       italic(\"serenoa repens\"),\n       \" individuals\"))\n       )+\n  theme_light()\n\n\n\n\nFigure 2. Histograms of number of green leaves (n) in the palmetto plant species sabal etonia and serenoa repens. Data: Abrahamson (2019)\nIn figure 2 we can clearly see that most sabal etonia plants have 5 or less green levaes. These are fewer green leaves than what serenoa repens plants have, serenoa repens plants have a median of about 7 green leaves per plant.\n\nhide\n# --- GRAPH 3: HEIGHT\n\nggplot(data=palmetto, aes(x=species, y=height))+\n  geom_jitter(color=\"forestgreen\", size=0.4, alpha=0.2) +\n  geom_boxplot(alpha=0)+\n  labs(y = \"height (cm)\",\n        title = expression(paste(\n       \"Height of \",\n       italic(\"sabal etonia\"),\n       \" and \",\n       italic(\"serenoa repens\"),\n       \" individuals\"))\n       )+\n  theme_minimal()\n\n\n\n\n\nhide\n# ---- DESCRIPTIVE STATISTICS ----\nsummary_palmetto <- palmetto %>% \n  group_by(species) %>% \n  summarize(mean = mean(height, na.rm=TRUE),\n            sd = sd(height, na.rm=TRUE),\n            #median = median(weight, na.rm=TRUE),\n            n = n()\n            )\n\n# --- TWO SAMPLE T-TEST AND COHEN'S D ----\n\n# --- Convert data to vector form\nsabal_height <- palmetto %>% \n  filter(species == \"sabal etonia\") %>% \n  pull(height)\n\nserenoa_height <- palmetto %>% \n  filter(species == \"serenoa repens\") %>% \n  pull(height)\n\n# --- Two-sample t-test ---\nttest_height <- t.test(sabal_height,serenoa_height) %>% \n  tidy # make test parameters available for in-line referencing\n\n# --- Cohen's d ---\nheight_effsize <- cohen.d( serenoa_height,sabal_height, na.rm=TRUE)\n\n\n\nFigure 3. Height (cm) of the palmetto plant species sabal etonia and serenoa repens. Each green point indicates the height of an individual plant. Box endpoints indicate the 25th and 75th percentile values, the black line within the box indicate the median for each species. Black points at the end of the boxes indicate possible outliers. Data: Abrahamson (2019)\nOn average sabal etonia plants are shorter than serenoa repens plants: 90.09 \\(\\pm\\) 24.17 and 92.19 \\(\\pm\\) 28.11 cm, respectively (mean \\(\\pm\\) 1 standard deviation). The absolute difference in means is 2.1 cm, so on average the serenoa repens plants are 2.33% taller than sabal etonia plants. This difference in means is significant (Welch’s two-sample t-test: t(1.19707610^{4}) = -4.44, p< 0.001) however the effect size is small (Cohen’s d = 0.08).\nBinary logistic regression\nBased on the preliminary data visualization and analysis, it seems possible that the differences in canopy dimensions, height and number of green leaves for serenoa repens and sabal etonia plant species are significant. These characteristics could be used classify whether a palmetto plant belongs to either one of these species. To assess this we used a binary logistic regression to create a classification, the coefficients of the model are shown in the following table.\nTable 1.  Coefficients of the binary logistic regression model for classifying serenoa repens and sabal etonia palmetto plants based on their height (cm), canopy length and width (cm) and number of green leaves (n). The standard error and p-values for each coefficient are included. Data: Abrahamson (2019).\n\nhide\n# ---- BINARY LOGISTIC REGRESSION ---- \n\n# -- create model\nblr_palmetto <- glm(species ~ height + length + width + green_lvs,\n                            data = palmetto,\n                            family = \"binomial\") #specify model is BLR\n\n# -- table with model information \nblr_model <- tidy(blr_palmetto) %>% \n  mutate(pvalue = \"< 0.001\") %>%     # after looking at p-values, they are all <0.001\n  mutate(term = c(\"y-intercept\",     # update variable names\n                  \"height (cm)\", \n                  \"length (cm)\", \n                  \"width (cm)\", \n                  \"number of green leaves (n)\")\n         ) %>% \n  select(!statistic & !p.value)%>%   # exclude statistic and p-value columns\n  kable( col.names = c(\"Variable\",   # turn into kable and update column names\n                        \"Coefficient\", \n                        \"Standard error\",\n                        \"p-value\") \n                         ) %>% \n   kable_styling(full_width = FALSE) \n\nblr_model\n\n\n\nVariable\n\n\nCoefficient\n\n\nStandard error\n\n\np-value\n\n\ny-intercept\n\n\n-3.2266851\n\n\n0.1420708\n\n\n< 0.001\n\n\nheight (cm)\n\n\n0.0292173\n\n\n0.0023061\n\n\n< 0.001\n\n\nlength (cm)\n\n\n-0.0458233\n\n\n0.0018661\n\n\n< 0.001\n\n\nwidth (cm)\n\n\n-0.0394434\n\n\n0.0021000\n\n\n< 0.001\n\n\nnumber of green leaves (n)\n\n\n1.9084747\n\n\n0.0388634\n\n\n< 0.001\n\n\nModel accuracy\nBased on the previous binary logistic regression we constructed a probability function \\(P\\) dependent on a plant’s height \\(h\\) (cm), canopy length \\(l\\) (cm), canopy width \\(w\\) (cm) and number of green leaves \\(n\\). Then \\(P(h,l,w,n)\\) is the probability that a palmetto plant with the specified measurements being a serenoa repens. If \\(X\\) is an individual of species serenoa repens with measurements \\(h, l,w\\) and \\(n\\), we consider \\(X\\) to be correctly classified by the model if \\(P(h,l,w,n)>0.5\\). Similarly, if \\(X\\) is an individual of species sabal etonia with measurements \\(h, l,w\\) and \\(n\\), we consider \\(X\\) to be correctly classified by the model if \\(P(h,l,w,n)\\leq 0.5\\).\nTable 2. Number and percentages of each species correctly and incorrectly classified by the model.\n\nhide\n# ---- MODEL ACCURACY ---- \n\nresults_blr <- blr_palmetto %>% \n  broom::augment(type.predict=\"response\") %>% # calculate probability for each outcome\n  select(species,.fitted) %>%                 # select species and probability columns only\n  # check if classifcation is correct\n  mutate(classification = case_when( .fitted>0.5 & species==\"serenoa repens\"~ \"True\",   \n                                     .fitted<=0.5 & species==\"serenoa repens\"~ \"False\",\n                                     .fitted>0.5 & species==\"sabal etonia\"~ \"False\",\n                                     .fitted<=0.5 & species==\"sabal etonia\"~ \"True\")) %>% \n  count(species, classification) %>%    \n  mutate(percentage = case_when(     # add column with percentages \n    species == \"sabal etonia\" ~ scales::percent(n/(454+5701),accuracy = 0.01),\n    species == \"serenoa repens\" ~ scales::percent(n/(564+5548),accuracy = 0.01))\n    ) %>% \n  kable( col.names = c(\"Species\",    # create kable table, update column names\n                        \"Correctly classified by model\", \n                        \"Count\",\n                       \"Percentage\") \n                         ) %>% \n   kable_styling(full_width = FALSE)\n\nresults_blr\n\n\n\nSpecies\n\n\nCorrectly classified by model\n\n\nCount\n\n\nPercentage\n\n\nsabal etonia\n\n\nFalse\n\n\n454\n\n\n7.38%\n\n\nsabal etonia\n\n\nTrue\n\n\n5701\n\n\n92.62%\n\n\nserenoa repens\n\n\nFalse\n\n\n564\n\n\n9.23%\n\n\nserenoa repens\n\n\nTrue\n\n\n5548\n\n\n90.77%\n\n\nCitation\nAbrahamson, W.G. 2019. Survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017, ongoing at 5-year intervals ver 1. Environmental Data Initiative. https://doi.org/10.6073/pasta/f2f96ec76fbbd4b9db431c79a770c4d5\n\n\n\n",
    "preview": "posts/2021-03-11-palmetto-log-regression/palmetto-log-regression_files/figure-html5/unnamed-chunk-5-1.png",
    "last_modified": "2021-03-11T21:21:59-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-03-11-cheese-pca/",
    "title": "Cheeses: how similar are they depending on their country of origin",
    "description": "Principal component analysis (PCA) on the nutrition data for 45 types of cheeses from 10 countries.",
    "author": [
      {
        "name": "Carmen Galaz-García",
        "url": {}
      }
    ],
    "date": "2021-01-25",
    "categories": [],
    "contents": "\nIntroduction\nIn this report we perform a principal component analysis (PCA) on the nutrition data for 45 types of cheeses and examine whether cheeses with the same country of origin form data clusters. The variables used in the analysis are energy (kcal), protein (g), fat (g), carbohydrate (g) and sugar (g) present in \\(x\\) grams of cheese. We assume the quantity \\(x\\) is the same for al cheeses, thought its value was unfortunately not found. We chose the variables according to what is usually most visible in the “Nutrition Facts” label in food products. A PCA analysis is appropriate given the sample size (greater than 10) and since all the indicated variables are continuous. We work under the assumption that variables are linearly related.\nThe data comes from the Food nutrient information for raw fruits and veggies from USDA database of the FoodData Central in the U.S. Department of Agriculture. https://fdc.nal.usda.gov/index.html\nAll analyses are in R version 4.0.2 using RStudio Version 1.3.1093.\n\n\n\nFigure 1: ‘Cheese’ by rjhuttondfw is licensed under CC BY 2.0\n\n\n\nData wrangling\n\nShow code\n# ---- DATA READING ----\nfood <- read.csv(here(\"Task2_PCA\",\"usda_nutrients.csv\")) %>% \n  clean_names() %>%      \n  drop_na()              # remove NA values\n\n# ----- DATA SELECTION -----\ncheeses <- food %>% \n  filter(str_detect(short_descrip, \"CHEESE,\"),   # select cheeses\n         str_detect(food_group, \"Dairy\") ) %>% \n  select(!(id:short_descrip) & !(common_name:scientific_name)) %>%   # select variables used in analysis\n  select(descrip:sugar_g) %>% \n  mutate(descrip = str_sub(descrip, start=9)) %>% # remove \"cheese\" from description\n  separate(descrip,                               # separate cheese name from characteristics\n           into=c(\"name\", \"type\"), \n           sep=\",\", \n           extra=\"merge\") %>%\n  filter(!str_detect(name,\"fat|pasteurized|sodium\")) %>%     # remove \"altered\" cheeses\n  filter(!str_detect(type,\"fat|pasteurized|sodium|with|low|imitation\") | is.na(type)) %>% \n  mutate(origin = case_when(                      # label each cheese by country of origin\n    name == \"mexican\" ~ \"mex\",\n    str_detect(type,\"queso\")~ \"mex\",\n    str_detect(name,\"cheddar|cottage|monterey|muenster|brick|caraway|colby\") ~ \"us\",\n    str_detect(name,\"fontina|parmesan|mozzarella|provolone|ricotta|romano\") ~ \"it\",\n    str_detect(name,\"camembert|brie|roquefort|port de salut|blue\")~ \"fr\",\n    str_detect(name,\"gruyere|neufchatel|swiss|tilsit\") ~ \"sw\",\n    str_detect(name,\"gouda|edam|limburger\") ~ \"nth\"\n  )) %>% \n  relocate(origin)    # group categorical variables at beginning\n\n\n\nPrincipal Component Analysis and Biplot\n\nShow code\n# ---- PRINCIPAL COMPONENT ANALYSIS ----\ncheeses_PCA <- cheeses %>% \n  select(4:8) %>%    # select numerical variables\n  scale() %>% \n  prcomp\n\n# ----- BIPLOT -----\ncheese_biplot <- autoplot(cheeses_PCA,   # automatically recognizes PCA and does biplot\n         data= cheeses,\n         colour = 'origin',\n         #shape=FALSE,      # takes out points and shows individual labels\n         #label.size = 4,\n         loadings = TRUE,\n         loadings.label=TRUE)  +\n  theme_minimal()  +\n  labs(colour=\"Country of origin\") +  # add labels\n  scale_color_hue(labels= c(\"France\", \"Italy\", \"Mexico\",\"Netherlands\",\"Switzerland\",\"USA\", \"Other\"))\n\ncheese_biplot\n\n\n\n\n\n\nFigure 2. PCA biplot showing the relationships between energy (kcal), protein (g), fat (g), carbohydrate (g) and sugar (g) present in \\(x\\) grams of cheese. Each dot represents a different type of cheese. The color of a dote indicates the country of origin of the cheese.\nExploratory Findings\nThe PCA for our cheeses data set reveals that 71.32% of the variability is explained by the first two principal components. The biplot in figure 2 shows there is a similar and large variance with respect to PC1 and PC2 across energy, fat and protein content, while sugar content has a small variance. Figure 1 also shows the following major relations between the variables:\nSugar and protein present in cheese are negatively correlated.\nCarbohydrates seem to be quite unrelated to all other variables.\nEnergy and fat are positively correlated.\nAs for data clusters with respect to the cheese’s country of origin the biplot shows that:\nCheeses from the US form the tightest cluster, with cottage cheese as an outlier on the far right. Mexican cheeses also form a small cluster with small coefficients on both PC1 and PC2.\nItalian cheeses are quite spread out along PC1, with shredded parmesan on the far left and ricotta on the far right.\nGjetost cheese (a kind of Norwegian cheese) on the top seems like the biggest outlier.\n\n\n\n",
    "preview": {},
    "last_modified": "2021-03-12T11:49:59-08:00",
    "input_file": "cheese-pca.utf8.md"
  },
  {
    "path": "posts/2021-01-18-welcome/",
    "title": "welcome",
    "description": "This is my first blog post :)",
    "author": [
      {
        "name": "Carmen Galaz-García",
        "url": {}
      }
    ],
    "date": "2021-01-18",
    "categories": [],
    "contents": "\nOla ke ase !!!!\n\n\n\n",
    "preview": {},
    "last_modified": "2021-03-11T13:31:56-08:00",
    "input_file": {}
  }
]
